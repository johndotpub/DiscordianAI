[tox]
envlist = py311,py312, lint, test

[testenv]
deps =
    isort
    black
    ruff
    pytest
    pytest-asyncio
    coverage
extras = dev
commands =
    pytest --cov=src --cov-report=term-missing --cov-fail-under=80

[testenv:lint]
deps =
    isort
    black
    ruff
commands =
    # Modern Python linting pipeline: isort + black + ruff
    isort . --check-only --diff
    black . --check --diff
    ruff check . --show-fixes

[testenv:format]
deps =
    isort
    black
    ruff
commands =
    # Apply modern formatting and safe fixes
    isort .
    black .
    ruff check . --fix

[testenv:test]
deps =
    pytest
    pytest-asyncio
    coverage
commands =
    coverage run -m pytest
    coverage report --fail-under=80
    coverage html
